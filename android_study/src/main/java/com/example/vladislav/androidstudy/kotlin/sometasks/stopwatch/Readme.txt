–°–µ–∫—É–Ω–¥–æ–º–µ—Ä –ø–æ –ø–æ–¥–æ–±–Ω—ã–π —Ç–æ–º—É —á—Ç–æ –µ—Å—Ç—å –≤ –º–æ–±–∏–ª–∞—Ö.

–ó–∞–ø—Ä–æ—Å: (–ü–†–ò–ú–ï–†–ù–´–ô –ó–ê–ü–†–û–°) –ö–∞–∂–µ—Ç—Å—è –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ —Å–ª–∏—à–∫–æ–º –Ω–∞–≥—Ä—É–∂–µ–Ω...

–û—Ç–≤–µ—Ç –ì–∏–≥–∞—á–∞—Ç–∞:
    –í–æ—Ç –≤–∞—à —Ç–µ–∫—É—â–∏–π –∫–æ–¥:
withContext(Dispatchers.IO) {
    currentTime = System.currentTimeMillis() - initialTime - pausedTime
}
withContext(Dispatchers.Main) {
    _tellTimeState.value = StopwatchState.TellTime(currentTime)
}

–í—ã:
    –°—á–∏—Ç–∞–µ—Ç–µ –≤—Ä–µ–º—è –≤ IO (–ø—Ä–∞–≤–∏–ª—å–Ω–æ),
    –ù–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ Main (—á—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!).

üî¥ _tellTimeState.value = ... ‚Äî —ç—Ç–æ –Ω–µ UI-–æ–ø–µ—Ä–∞—Ü–∏—è, —ç—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ MutableStateFlow, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

‚úÖ –†–µ—à–µ–Ω–∏–µ: –û–±–Ω–æ–≤–ª—è–π—Ç–µ StateFlow –≤ Dispatchers.Default, –∞ –Ω–µ –≤ Main
StateFlow ‚Äî —ç—Ç–æ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ.
üëâ –û–±–Ω–æ–≤–ª—è—Ç—å MutableStateFlow –º–æ–∂–Ω–æ –≤ –ª—é–±–æ–º –¥–∏—Å–ø–µ—Ç—á–µ—Ä–µ, –≤–∫–ª—é—á–∞—è Dispatchers.Default –∏–ª–∏ IO.

‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π tellTime():
private fun tellTime() = viewModelScope.launch(Dispatchers.Default) {
    while (isActive) {
        try {
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è ‚Äî –≤ –ª—é–±–æ–º —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ
            currentTime = System.currentTimeMillis() - initialTime - pausedTime

            // –û–±–Ω–æ–≤–ª—è–µ–º StateFlow ‚Äî —Ç–æ–∂–µ –º–æ–∂–Ω–æ –≤ —Ñ–æ–Ω–µ!
            _tellTimeState.value = StopwatchState.TellTime(currentTime)

            // –ñ–¥—ë–º 10 –º—Å (–∏–ª–∏ 16 –º—Å ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω—É–∂–Ω–æ–π —á–∞—Å—Ç–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
            delay(16) // ~60 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ UI

            // –ï—Å–ª–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Äî —É—Ö–æ–¥–∏–º –≤ "—Åuspended" —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            if (isPaused) {
                suspensionManager.suspendIndefinitely()
            }
        } catch (e: Exception) {
            Log.e(TAG, "Error in tellTime loop", e)
            break
        }
    }
}

‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:
–ß—Ç–æ –±—ã–ª–æ
    –ß—Ç–æ —Å—Ç–∞–ª–æ
        –í—ã–≥–æ–¥–∞
withContext(Dispatchers.IO) + withContext(Dispatchers.Main)
    –ü—Ä–æ—Å—Ç–æ viewModelScope.launch(Dispatchers.Default)
        –ù–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ _tellTimeState –Ω–∞ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ
        –ì–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –Ω–µ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
delay(10) ‚Äî —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ
    delay(16) ‚Äî 60 FPS, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è UI
        –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏, –ø–ª–∞–≤–Ω–æ

‚úÖ –ê –∫–æ–≥–¥–∞ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –≤—Å—ë –∂–µ –Ω—É–∂–µ–Ω?
–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å View, Compose, LiveData, –∏–ª–∏ –¥—Ä—É–≥–∏–µ UI-–ø—Ä–∏–º–∏—Ç–∏–≤—ã, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.
–ù–æ:

StateFlow ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.
ViewModel ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.
collectAsState() –≤ Composable ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–∞ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ, –¥–∞–∂–µ –µ—Å–ª–∏ StateFlow –æ–±–Ω–æ–≤–ª—è–ª—Å—è –≤ —Ñ–æ–Ω–µ.

‚úÖ –¢–æ –µ—Å—Ç—å: –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø–æ–∫–æ–π–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å StateFlow –≤ Default, –∞ Composable –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —ç—Ç–æ –≤ Main.

‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –ò–∑–±–µ–≥–∞–π—Ç–µ –ª–∏—à–Ω–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
–ï—Å–ª–∏ –≤—ã –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ StateFlow 100 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É, –Ω–æ UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 60 —Ä–∞–∑ ‚Äî —ç—Ç–æ –ª–∏—à–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞.
üëâ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ delay(16) ‚Äî —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å callbackFlow + ticker (–¥–ª—è –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏)
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –µ—â—ë –±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å callbackFlow:
val timerFlow: Flow<Long> = callbackFlow {
    while (true) {
        delay(16)
        trySend(System.currentTimeMillis() - initialTime - pausedTime)
    }
}.flowOn(Dispatchers.Default)

–ù–æ –≤ –≤–∞—à–µ–º —Å–ª—É—á–∞–µ ‚Äî StateFlow + —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏ –ø—Ä–æ—â–µ.
‚úÖ –ò—Ç–æ–≥: –ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
private fun tellTime() = viewModelScope.launch(Dispatchers.Default) {
    while (isActive) {
        if (!isPaused) {
            currentTime = System.currentTimeMillis() - initialTime - pausedTime
            _tellTimeState.value = StopwatchState.TellTime(currentTime)
        }
        delay(16) // 60 FPS
    }
}

üî• –ì–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏.
üß† collectAsState() –≤ Composable –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ Main, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å.

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?
–î–∞! MutableStateFlow:
    –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–µ–Ω (–µ—Å–ª–∏ –≤—ã –Ω–µ –¥–µ–ª–∞–µ—Ç–µ —Å–ª–æ–∂–Ω—ã–µ mutable operations).
    –ú–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∏–∑ –ª—é–±–æ–≥–æ –ø–æ—Ç–æ–∫–∞.
    viewModelScope –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç–º–µ–Ω—É –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ ViewModel.









–ó–∞–ø—Ä–æ—Å: –ï—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ - "–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–Ω–∞—Ä—É–∂–∏". –Ø —Ç–∞–∫ –ø–æ–Ω–∏–º–∞—é –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ª—É—á—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å StateFlow, –∞ —á—Ç–æ —Ç–æ–≥–¥–∞ ?

–û—Ç–≤–µ—Ç –ì–∏–≥–∞—á–∞—Ç:
–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –¢—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤: –µ—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ **–Ω–µ –Ω—É–∂–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–Ω–∞—Ä—É–∂–∏** (—Ç–æ –µ—Å—Ç—å –∏–∑ UI –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∏–ª–∏ –∞–∫—Ç–∏–≤–∏—Ç–∏), —Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `StateFlow` ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω–æ –∏ –º–æ–∂–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω–æ–º.

### –ü–æ—á–µ–º—É `StateFlow` –Ω–µ –Ω—É–∂–µ–Ω, –µ—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è —Å–Ω–∞—Ä—É–∂–∏?

`StateFlow` ‚Äî —ç—Ç–æ **shared mutable state**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è **–Ω–∞–±–ª—é–¥–µ–Ω–∏—è** (observation) –∏–∑–≤–Ω–µ. –û–Ω —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã:
- UI –º–æ–≥ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è,
- –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –∏–∑ –∫–æ—Ä—É—Ç–∏–Ω.

–ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω –≤–Ω–µ—à–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—à–∞—Ç—å —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî –Ω–µ—Ç —Å–º—ã—Å–ª–∞:
- —Ö—Ä–∞–Ω–∏—Ç—å –µ–≥–æ –≤ `MutableStateFlow`,
- —Ç—Ä–∞—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π,
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å "–∏—Å—Ç–æ—Ä–∏—é" –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è,
- —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø–æ–¥–ø–∏—Å–æ–∫.

---

### –ß—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ `StateFlow`?

–ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ `ViewModel`**, —Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ **–æ–±—ã—á–Ω–æ–π –∏–∑–º–µ–Ω—è–µ–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π** (`var`) –∏–ª–∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, `MutableState` / `AtomicReference` ‚Äî –Ω–æ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ —Ö–≤–∞—Ç–∏—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ `var`.

---

### –ü—Ä–∏–º–µ—Ä: –∑–∞–º–µ–Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö `_splitStopStopwatchState` –∏ `_pauseContinuePauseStopwatchState`

–°–µ–π—á–∞—Å —É —Ç–µ–±—è –µ—Å—Ç—å:

```kotlin
private val _splitStopStopwatchState: MutableStateFlow<StopwatchState> =
    MutableStateFlow(StopwatchState.Initial)
//    splitStopTimerState –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–Ω–∞—Ä—É–∂–∏

private val _pauseContinuePauseStopwatchState: MutableStateFlow<StopwatchState> =
    MutableStateFlow(StopwatchState.Continue)
//    pauseContinuePauseTimerState –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–Ω–∞—Ä—É–∂–∏
```

–ê –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ:

```kotlin
private var splitStopStopwatchState: StopwatchState = StopwatchState.Initial
private var pauseContinuePauseStopwatchState: StopwatchState = StopwatchState.Continue
```

–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```kotlin
fun onSplitOrStopClick() {
    if (pauseContinuePauseStopwatchState == StopwatchState.Continue) {
        splitStopStopwatchState = StopwatchState.Split(currentTime)
        // ...
    }
    // ...
}
```

---

### –ü–æ—á–µ–º—É —Ç–æ–≥–¥–∞ `splitsState`, `stopwatchState`, `timerState` ‚Äî –æ—Å—Ç–∞—é—Ç—Å—è `StateFlow`?

–ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ **–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –≤–Ω–µ—à–Ω–µ–º –∫–æ–¥–µ (UI)**:

- `splitsState` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ —Å–ø–ª–∏—Ç–æ–≤,
- `stopwatchState` ‚Äî –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–æ–∫ –∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–∏,
- `timerState` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ.

–ò—Ö **—Å–ª—É—à–∞–µ—Ç UI**, –∑–Ω–∞—á–∏—Ç, –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `StateFlow`.

---

### –í—ã–≤–æ–¥

‚úÖ **–û—Å—Ç–∞–≤—å `StateFlow`**, –µ—Å–ª–∏:
- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –∏–∑–≤–Ω–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `Fragment` –∏–ª–∏ `Activity`),
- –æ–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ UI.

‚ùå **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π `StateFlow`**, –µ—Å–ª–∏:
- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞**,
- –Ω–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ —Å–Ω–∞—Ä—É–∂–∏.

üîß **–ó–∞–º–µ–Ω–∏ –Ω–∞ –æ–±—ã—á–Ω—ã–µ `var`** –≤ —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö.

---

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞:

```kotlin src/main/java/com/example/vladislav/androidstudy/kotlin/sometasks/stopwatch/StopwatchViewModel.kt
private var splitStopStopwatchState: StopwatchState = StopwatchState.Initial
private var pauseContinuePauseStopwatchState: StopwatchState = StopwatchState.Continue
```

–ê —Ç–∞–∫–∂–µ —É–¥–∞–ª–∏ `asStateFlow()` –∏ –ø—É–±–ª–∏—á–Ω—ã–µ –≥–µ—Ç—Ç–µ—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

---

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏)

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å **–≤–Ω—É—Ç—Ä–∏** `ViewModel` (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è), –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å:
- `Channel` / `SharedFlow` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–±—ã—Ç–∏–π–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ),
- –Ω–æ —á–∞—â–µ –≤—Å–µ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `var`.

–ù–æ –≤ —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ ‚Äî –ø—Ä–æ—Å—Ç—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç.

---

‚úÖ **–ò—Ç–æ–≥**:
–£–±–µ—Ä–∏ `StateFlow` –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π ‚Äî –∑–∞–º–µ–Ω–∏ –Ω–∞ `var`. –≠—Ç–æ —É–ø—Ä–æ—Å—Ç–∏—Ç –∫–æ–¥, —É–º–µ–Ω—å—à–∏—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∏ —Å–¥–µ–ª–∞–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è —è—Å–Ω–µ–µ.